{"version":3,"sources":["../../src/pixlive.directive.ts"],"names":[],"mappings":"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","file":"pixlive.directive.js","sourceRoot":"","sourcesContent":["import { Directive, ElementRef, OnInit, Renderer }      from '@angular/core';\nimport { Platform, ViewController } from 'ionic-angular';\n\ndeclare var window;\n\n\nexport class PixliveDirective implements OnInit {\n\n  private arView;\n  private fakeCamera;\n\n  constructor(private platform: Platform, private el: ElementRef, private renderer: Renderer, private viewCtrl: ViewController) {\n\n  }\n\n  public getNativeElement() {\n    return this.el.nativeElement;\n  }\n\n  private initArViewLifeCycle() {\n    this.viewCtrl.willEnter.subscribe(() => {\n      console.log(\"will enter\");\n      if (this.arView) {\n        console.log(\"XXXXXX Opening - beforeEnter\");\n        this.arView.beforeEnter();\n        this.onOrientationChange(this.el, this.arView);\n      }\n    });\n    this.viewCtrl.didEnter.subscribe(() => {\n      console.log(\"did enter\");\n      if (this.arView) {\n        console.log(\"XXXXXX Opening - afterEnter\");\n        this.arView.afterEnter();\n      }\n      if (this.fakeCamera) {\n        this.renderer.setElementStyle(this.fakeCamera, 'display', 'block');\n      }\n    });\n    this.viewCtrl.willLeave.subscribe(() => {\n      console.log(\"will leave\");\n      if (this.arView) {\n        console.log(\"XXXXXX Closing - beforeLeave\");\n        this.arView.beforeLeave();\n      }\n      if (this.fakeCamera) {\n        this.renderer.setElementStyle(this.fakeCamera, 'display', 'none');\n      }\n    });\n    this.viewCtrl.willUnload.subscribe(() => {\n      console.log(\"will unload\");\n    });\n    this.viewCtrl.didLeave.subscribe(() => {\n      console.log(\"did leave\");\n      if (this.arView) {\n        console.log(\"XXXXXX Closing - afterLeave\");\n        this.arView.afterLeave();\n      }\n    });\n  }\n\n  private onOrientationChange(element, view) {\n    console.log(\"orientation change\");\n    console.log(JSON.stringify(element.nativeElement.getBoundingClientRect()));\n    setTimeout(() => {\n      let rect = element.nativeElement.getBoundingClientRect();\n      console.log(JSON.stringify(rect));\n      view.resize(rect.left, rect.top, rect.width, rect.height);\n    }, 300);\n  }\n\n  ngOnInit() {\n    this.renderer.setElementStyle(this.el.nativeElement, 'display', 'inline-block');\n\n    this.initArViewLifeCycle();\n\n    this.platform.ready().then(() => {\n      console.log(\"platform ready\");\n      setTimeout(() => {\n        let rect = this.el.nativeElement.getBoundingClientRect();\n        if (window.cordova) {\n          console.log(\"creating AR view\");\n          this.arView = window.cordova.plugins.PixLive.createARView(rect.left, rect.top, rect.width, rect.height);\n          console.log(\"AR view created\");\n\n          let element = this.el;\n          let view = this.arView;\n          let fct = this.onOrientationChange;\n          window.addEventListener(\"orientationchange\", function () {\n            fct(element, view);\n          }, false);\n        } else {\n          let fakeCamera = document.createElement(\"DIV\");\n          document.body.appendChild(fakeCamera);\n          this.renderer.setElementStyle(fakeCamera, 'position', 'fixed');\n          this.renderer.setElementStyle(fakeCamera, 'background-color', 'gray');\n          this.renderer.setElementStyle(fakeCamera, 'left', rect.left + 'px');\n          this.renderer.setElementStyle(fakeCamera, 'top', rect.top + 'px');\n          this.renderer.setElementStyle(fakeCamera, 'width', rect.width + 'px');\n          this.renderer.setElementStyle(fakeCamera, 'height', rect.height + 'px');\n          this.fakeCamera = fakeCamera;\n        }\n      }, 300);\n    });\n\n\n    let node = this.el.nativeElement.parentElement;\n    while (node) {\n      this.renderer.setElementStyle(node, 'background-color', 'transparent');\n      node = node.parentElement;\n    }\n\n    // let rect = this.el.nativeElement.getBoundingClientRect();\n    // console.log(this.el);\n    // console.log(rect);\n\n    // this.viewCtrl..subscribe(() => {\n    //   console.log(\"did enter\");\n    //   let rect = this.el.nativeElement.getBoundingClientRect();\n    //   console.log(rect);\n    //   console.log(window.scrollX + \" \" + window.scrollY);\n    // });\n  }\n\n  ngAfterViewInit() {\n    console.log(\"ng after view init\");\n  }\n\n  ngDoCheck() {\n    console.log(\"ng do check\");\n  }\n\n  ngAfterViewChecked() {\n    console.log(\"ng after view checked\");\n  }\n\n  public setTouchEnabled(enabled: boolean) {\n    if (enabled) {\n      this.arView.enableTouch();\n    } else {\n      this.arView.disableTouch();\n    }\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  //moduleId: module.id,\n  selector: 'pixlive-camera-view'\n  //templateUrl: 'pixlive.component.html'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Platform, },\n{type: ElementRef, },\n{type: Renderer, },\n{type: ViewController, },\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}